{"version":3,"sources":["pivot_spec.coffee","pivot_spec.min.js"],"names":["fixtureData","raggedFixtureData","name","colour","age","gender","describe","table","beforeEach","done","$","pivotUI","onRefresh","it","expect","find","length","toBe","val","text","join","data","rows","cols","aggregatorName","vals","rendererName","pivot","aggregators","derivers","ref","sortAs","pivotUtilities","aggregator","filter","record","derivedAttributes","birthyear","dateFormat","trialbins","bin","sorters","attr","received_PivotData","received_rendererOptions","count2x","push","this","value","format","x","renderer","a","b","addClass","greeting","rendererOptions","agg","getAggregator","sumOverSumOpts","aoaInput","pd","PivotData","aosInput","raggedAosInput","functionInput","tableInput","key","ym","getRowKeys","toEqual","getColKeys","c","i","j","len","len1","numNotNull","numNull","r","ref1","records","forEachMatchingRecord","getVal","tpl","aggregatorTemplates","count","countUnique","listUnique","average","sum","min","max","first","last","median","quantile","stdev","sumOverSum","naturalSort","sortedArr","slice","sort","numberFormat","nf","scaler","suffix","thousandsSep","decimalSep","prefix","digitsAfterDecimal","df","Date","binner","toBeNaN","call"],"mappings":"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","file":"pivot_spec.min.js","sourcesContent":["fixtureData = [\n    [\"name\",    \"gender\",   \"colour\",    \"birthday\",     \"trials\",   \"successes\"],\n    [\"Nick\",    \"male\",     \"blue\",      \"1982-11-07\",   103,        12],\n    [\"Jane\",    \"female\",   \"red\",       \"1982-11-08\",   95,         25],\n    [\"John\",    \"male\",     \"blue\",      \"1982-12-08\",   112,        30],\n    [\"Carol\",   \"female\",   \"yellow\",    \"1983-12-08\",   102,        14]\n]\n\nraggedFixtureData = [\n    {name: \"Nick\", \"colour\": \"red\", \"age\": 34}\n    {name: \"Jane\", \"gender\": \"female\"}\n    {name: \"John\", \"gender\": \"male\", \"age\": 12}\n    {name: \"Jim\", \"gender\": null, \"age\": 12}\n]\n\ndescribe \"$.pivotUI()\", ->\n    describe \"with no rows/cols, default count aggregator, default TableRenderer\",  ->\n        table = null\n\n        beforeEach (done) ->\n            table = $(\"<div>\").pivotUI fixtureData, onRefresh: done\n        it \"has all the basic UI elements\", (done) ->\n            expect table.find(\"td.pvtAxisContainer\").length\n            .toBe  3\n            expect table.find(\"td.pvtRendererArea\").length\n            .toBe  1\n            expect table.find(\"td.pvtVals\").length\n            .toBe  1\n            expect table.find(\"select.pvtRenderer\").length\n            .toBe  1\n            expect table.find(\"select.pvtAggregator\").length\n            .toBe  1\n            expect table.find(\"span.pvtAttr\").length\n            .toBe  6\n            done()\n\n        it \"reflects its inputs\", (done) ->\n            expect table.find(\"td.pvtUnused span.pvtAttr\").length\n            .toBe  6\n            expect table.find(\"select.pvtRenderer\").val()\n            .toBe  \"Table\"\n            expect table.find(\"select.pvtAggregator\").val()\n            .toBe  \"Count\"\n            done()\n\n        it \"renders a table\", (done) ->\n            expect table.find(\"table.pvtTable\").length\n            .toBe  1\n            done()\n\n\n        describe \"its renderer output\", ->\n            it \"has the correct type and number of cells\", (done) ->\n                expect table.find(\"th.pvtTotalLabel\").length\n                .toBe  1\n                expect table.find(\"td.pvtGrandTotal\").length\n                .toBe  1\n                done()\n\n            it \"has the correct textual representation\", (done) ->\n                expect table.find(\"table.pvtTable\").text()\n                .toBe [\"Totals\", \"4\"].join(\"\")\n                done()\n\n            it \"has a correct grand total with data value\", (done) ->\n                expect table.find(\"td.pvtGrandTotal\").text()\n                .toBe  \"4\"\n                expect table.find(\"td.pvtGrandTotal\").data(\"value\")\n                .toBe  4\n                done()\n\n    describe \"with rows/cols, sum-over-sum aggregator, Heatmap renderer\",  ->\n        table = null\n\n        beforeEach (done) ->\n            table = $(\"<div>\").pivotUI fixtureData,\n                rows: [\"gender\"], cols: [\"colour\"]\n                aggregatorName: \"Sum over Sum\"\n                vals: [\"successes\", \"trials\"]\n                rendererName: \"Heatmap\"\n                onRefresh: done\n\n        it \"has all the basic UI elements\", (done) ->\n            expect table.find(\"td.pvtAxisContainer\").length\n            .toBe  3\n            expect table.find(\"td.pvtRendererArea\").length\n            .toBe  1\n            expect table.find(\"td.pvtVals\").length\n            .toBe  1\n            expect table.find(\"select.pvtRenderer\").length\n            .toBe  1\n            expect table.find(\"select.pvtAggregator\").length\n            .toBe  1\n            expect table.find(\"span.pvtAttr\").length\n            .toBe  6\n            done()\n\n        it \"reflects its inputs\", (done) ->\n            expect table.find(\"td.pvtUnused span.pvtAttr\").length\n            .toBe  4\n            expect table.find(\"td.pvtRows span.pvtAttr\").length\n            .toBe  1\n            expect table.find(\"td.pvtCols span.pvtAttr\").length\n            .toBe  1\n            expect table.find(\"select.pvtRenderer\").val()\n            .toBe  \"Heatmap\"\n            expect table.find(\"select.pvtAggregator\").val()\n            .toBe  \"Sum over Sum\"\n            done()\n\n        it \"renders a table\", (done) ->\n            expect table.find(\"table.pvtTable\").length\n            .toBe  1\n            done()\n\n        describe \"its renderer output\", ->\n            it \"has the correct type and number of cells\", (done) ->\n                expect table.find(\"th.pvtAxisLabel\").length\n                .toBe  2\n                expect table.find(\"th.pvtRowLabel\").length\n                .toBe  2\n                expect table.find(\"th.pvtColLabel\").length\n                .toBe  3\n                expect table.find(\"th.pvtTotalLabel\").length\n                .toBe  2\n                expect table.find(\"td.pvtVal\").length\n                .toBe  6\n                expect table.find(\"td.pvtTotal\").length\n                .toBe  5\n                expect table.find(\"td.pvtGrandTotal\").length\n                .toBe  1\n                done()\n\n            it \"has the correct textual representation\", (done) ->\n                expect table.find(\"table.pvtTable\").text()\n                .toBe [\n                    \"colour\",   \"blue\", \"red\",  \"yellow\",   \"Totals\",\n                    \"gender\",\n                    \"female\",           \"0.26\", \"0.14\",     \"0.20\",\n                    \"male\",     \"0.20\",                     \"0.20\",\n                    \"Totals\",   \"0.20\", \"0.26\", \"0.14\",     \"0.20\"\n                    ].join(\"\")\n                done()\n\n            it \"has a correct spot-checked cell with data value\", (done) ->\n                expect table.find(\"td.col0.row1\").text()\n                .toBe  \"0.20\"\n                expect table.find(\"td.col0.row1\").data(\"value\")\n                .toBe  (12+30)/(103+112)\n                done()\n\n    describe \"with ragged input\",  ->\n        table = $(\"<div>\").pivotUI raggedFixtureData, rows: [\"gender\"], cols: [\"age\"]\n\n        it \"renders a table with the correct textual representation\", ->\n            expect table.find(\"table.pvtTable\").text()\n            .toBe [\n                \"age\",     \"12\",  \"34\",  \"null\",  \"Totals\"\n                \"gender\",\n                \"female\",                 \"1\",    \"1\"\n                \"male\",    \"1\",                   \"1\"\n                \"null\",    \"1\",    \"1\",           \"2\"\n                \"Totals\",  \"2\",    \"1\",   \"1\",    \"4\"\n                ].join(\"\")\n\ndescribe \"$.pivot()\", ->\n\n    describe \"with no rows/cols, default count aggregator, default TableRenderer\",  ->\n        table = $(\"<div>\").pivot fixtureData\n\n        it \"renders a table\", ->\n            expect table.find(\"table.pvtTable\").length\n            .toBe  1\n\n        describe \"its renderer output\", ->\n\n            it \"has the correct textual representation\", ->\n                expect table.find(\"table.pvtTable\").text()\n                .toBe [\"Totals\", \"4\"].join(\"\")\n\n            it \"has a correct grand total with data value\", ->\n                expect table.find(\"td.pvtGrandTotal\").text()\n                .toBe  \"4\"\n                expect table.find(\"td.pvtGrandTotal\").data(\"value\")\n                .toBe  4\n\n    describe \"with rows/cols, sum aggregator, derivedAttributes, filter and sorters\",  ->\n        {sortAs, derivers, aggregators} = $.pivotUtilities\n        table = $(\"<div>\").pivot fixtureData,\n            rows: [\"gender\"], cols: [\"birthyear\"], aggregator: aggregators[\"Sum\"]([\"trialbins\"])\n            filter: (record) -> record.name != \"Nick\"\n            derivedAttributes:\n                birthyear: derivers.dateFormat \"birthday\", \"%y\"\n                trialbins: derivers.bin \"trials\", 10\n            sorters: (attr) ->\n                if attr == \"gender\" then return sortAs([\"male\", \"female\"])\n\n        it \"renders a table with the correct textual representation\", ->\n            expect table.find(\"table.pvtTable\").text()\n            .toBe [\n                \"birthyear\",    \"1982\",     \"1983\",     \"Totals\"\n                \"gender\",\n                \"male\",         \"110.00\",               \"110.00\"\n                \"female\",       \"90.00\",    \"100.00\",   \"190.00\"\n                \"Totals\",       \"200.00\",   \"100.00\",   \"300.00\"\n                ].join(\"\")\n\n    describe \"with rows/cols, fraction-of aggregator\",  ->\n        {aggregators} = $.pivotUtilities\n        table = $(\"<div>\").pivot fixtureData,\n            rows: [\"gender\"]\n            aggregator: aggregators[\"Sum as Fraction of Total\"]([\"trials\"])\n\n        it \"renders a table with the correct textual representation\", ->\n            expect table.find(\"table.pvtTable\").text()\n            .toBe [\n                \"gender\",  \"Totals\"\n                \"female\",  \"47.8%\"\n                \"male\",    \"52.2%\"\n                \"Totals\",  \"100.0%\"\n                ].join(\"\")\n\n    describe \"with rows/cols, custom aggregator, custom renderer with options\",  ->\n        received_PivotData = null\n        received_rendererOptions = null\n\n        table = $(\"<div>\").pivot fixtureData,\n            rows: [\"name\", \"colour\"], cols: [\"trials\", \"successes\"]\n            aggregator: ->\n                count2x: 0\n                push: -> @count2x +=2\n                value: -> @count2x\n                format: (x) -> \"formatted \" + x\n            renderer: (a,b) ->\n                received_PivotData = a\n                received_rendererOptions = b\n                return $(\"<div>\").addClass(b.greeting).text(\"world\")\n            rendererOptions: {greeting:\"hithere\"}\n\n        it \"renders the custom renderer as per options\", ->\n            expect table.find(\"div.hithere\").length\n            .toBe  1\n\n        describe \"its received PivotData object\", ->\n            it \"has a correct grand total value and format for custom aggregator\", ->\n                agg = received_PivotData.getAggregator([],[])\n                val = agg.value()\n                expect(val).toBe 8\n                expect(agg.format(val)).toBe \"formatted 8\"\n\n\n    describe \"with ragged input\",  ->\n        table = $(\"<div>\").pivot raggedFixtureData, rows: [\"gender\"], cols: [\"age\"]\n\n        it \"renders a table with the correct textual representation\", ->\n            expect table.find(\"table.pvtTable\").text()\n            .toBe [\n                \"age\",     \"12\",  \"34\",  \"null\",  \"Totals\"\n                \"gender\",\n                \"female\",                 \"1\",    \"1\"\n                \"male\",    \"1\",                   \"1\"\n                \"null\",    \"1\",    \"1\",           \"2\"\n                \"Totals\",  \"2\",    \"1\",   \"1\",    \"4\"\n                ].join(\"\")\n\ndescribe \"$.pivotUtilities\", ->\n\n    describe \".PivotData()\", ->\n        sumOverSumOpts =\n            aggregator: $.pivotUtilities.aggregators[\"Sum over Sum\"]([\"a\",\"b\"])\n\n        describe \"with no options\", ->\n            aoaInput =  [ [\"a\",\"b\"], [1,2], [3,4] ]\n            pd = new $.pivotUtilities.PivotData aoaInput\n\n            it \"has the correct grand total value\", ->\n                expect pd.getAggregator([],[]).value()\n                .toBe 2\n\n        describe \"with array-of-array input\", ->\n            aoaInput =  [ [\"a\",\"b\"], [1,2], [3,4] ]\n            pd = new $.pivotUtilities.PivotData aoaInput, sumOverSumOpts\n\n            it \"has the correct grand total value\", ->\n                expect pd.getAggregator([],[]).value()\n                .toBe (1+3)/(2+4)\n\n        describe \"with array-of-object input\", ->\n            aosInput =  [ {a:1, b:2}, {a:3, b:4} ]\n            pd = new $.pivotUtilities.PivotData aosInput, sumOverSumOpts\n\n            it \"has the correct grand total value\", ->\n                expect pd.getAggregator([],[]).value()\n                .toBe (1+3)/(2+4)\n\n        describe \"with ragged array-of-object input\", ->\n            raggedAosInput =  [ {a:1}, {b:4}, {a: 3, b: 2} ]\n            pd = new $.pivotUtilities.PivotData raggedAosInput, sumOverSumOpts\n\n            it \"has the correct grand total value\", ->\n                expect pd.getAggregator([],[]).value()\n                .toBe (1+3)/(2+4)\n\n        describe \"with function input\", ->\n            functionInput = (record) ->\n                record a:1, b:2\n                record a:3, b:4\n            pd = new $.pivotUtilities.PivotData functionInput, sumOverSumOpts\n\n            it \"has the correct grand total value\", ->\n                expect pd.getAggregator([],[]).value()\n                .toBe (1+3)/(2+4)\n\n        describe \"with jQuery table element input\", ->\n            tableInput = $ \"\"\"\n                <table>\n                    <thead>\n                        <tr> <th>a</th><th>b</th> </tr>\n                    </thead>\n                    <tbody>\n                        <tr> <td>1</td> <td>2</td> </tr>\n                        <tr> <td>3</td> <td>4</td> </tr>\n                    </tbody>\n                </table>\n                \"\"\"\n            pd = new $.pivotUtilities.PivotData tableInput, sumOverSumOpts\n\n            it \"has the correct grand total value\", ->\n                expect pd.getAggregator([],[]).value()\n                .toBe (1+3)/(2+4)\n\n        describe \"with a0-a00 input\", ->\n            aoaInput =  [\n                {key: 'a0', ym: '2020-01'},\n                {key: 'a0', ym: '2020-02'},\n                {key: 'a00', ym: '2020-01'},\n                {key: 'a00', ym: '2020-02'}\n            ]\n            pd = new $.pivotUtilities.PivotData aoaInput, rows: [\"key\", \"ym\"], cols: []\n\n            it \"has correctly-ordered row keys\", ->\n                expect pd.getRowKeys()\n                .toEqual [[\"a0\",\"2020-01\"],[\"a0\",\"2020-02\"],[\"a00\",\"2020-01\"],[\"a00\",\"2020-02\"]]\n\n        describe \"with rows/cols\", ->\n            pd = new $.pivotUtilities.PivotData fixtureData,\n                rows: [\"name\", \"colour\"],\n                cols: [\"trials\", \"successes\"]\n\n            it \"has correctly-ordered row keys\", ->\n                expect pd.getRowKeys()\n                .toEqual [ [ 'Carol', 'yellow' ], [ 'Jane', 'red' ], [ 'John', 'blue' ], [ 'Nick', 'blue' ] ]\n\n            it \"has correctly-ordered col keys\", ->\n                expect pd.getColKeys()\n                .toEqual [ [ 95, 25 ], [ 102, 14 ], [ 103, 12 ], [ 112, 30 ] ]\n\n            it \"can be iterated over\", ->\n                numNotNull = 0\n                numNull = 0\n                for r in pd.getRowKeys()\n                    for c in pd.getColKeys()\n                        if pd.getAggregator(r, c).value()?\n                            numNotNull++\n                        else\n                            numNull++\n                expect numNotNull\n                .toBe 4\n                expect numNull\n                .toBe 12\n\n            it \"returns matching records\", ->\n                records = []\n                pd.forEachMatchingRecord gender: \"male\", (x) -> records.push(x.name)\n                expect records\n                .toEqual [\"Nick\", \"John\"]\n\n            it \"has a correct spot-checked aggregator\", ->\n                agg = pd.getAggregator([ 'Carol', 'yellow' ],[ 102, 14 ])\n                val = agg.value()\n                expect(val).toBe 1\n                expect(agg.format(val)).toBe \"1\"\n\n            it \"has a correct grand total aggregator\", ->\n                agg = pd.getAggregator([],[])\n                val = agg.value()\n                expect(val).toBe 4\n                expect(agg.format(val)).toBe \"4\"\n\n    describe \".aggregatorTemplates\", ->\n\n        getVal = (aggregator) ->\n            pd = new $.pivotUtilities.PivotData(fixtureData, {aggregator})\n            return pd.getAggregator([],[]).value()\n        tpl = $.pivotUtilities.aggregatorTemplates\n\n        describe \".count\", ->\n            it \"works\", ->\n                expect getVal(tpl.count()())\n                .toBe 4\n\n        describe \".countUnique\", ->\n            it \"works\", ->\n                expect getVal(tpl.countUnique()(['gender']))\n                .toBe 2\n\n        describe \".listUnique\", ->\n            it \"works\", ->\n                expect getVal(tpl.listUnique()(['gender']))\n                .toBe 'female,male'\n\n        describe \".average\", ->\n            it \"works\", ->\n                expect getVal(tpl.average()(['trials']))\n                .toBe 103\n\n        describe \".sum\", ->\n            it \"works\", ->\n                expect getVal(tpl.sum()(['trials']))\n                .toBe 412\n\n        describe \".min\", ->\n            it \"works\", ->\n                expect getVal(tpl.min()(['trials']))\n                .toBe 95\n\n        describe \".max\", ->\n            it \"works\", ->\n                expect getVal(tpl.max()(['trials']))\n                .toBe 112\n\n        describe \".first\", ->\n            it \"works\", ->\n                expect getVal(tpl.first()(['name']))\n                .toBe 'Carol'\n\n        describe \".last\", ->\n            it \"works\", ->\n                expect getVal(tpl.last()(['name']))\n                .toBe 'Nick'\n\n        describe \".average\", ->\n            it \"works\", ->\n                expect getVal(tpl.average()(['trials']))\n                .toBe 103\n\n        describe \".median\", ->\n            it \"works\", ->\n                expect getVal(tpl.median()(['trials']))\n                .toBe 102.5\n\n        describe \".quantile\", ->\n            it \"works\", ->\n                expect getVal(tpl.quantile(0)(['trials']))\n                .toBe 95\n                expect getVal(tpl.quantile(0.1)(['trials']))\n                .toBe 98.5\n                expect getVal(tpl.quantile(0.25)(['trials']))\n                .toBe 98.5\n                expect getVal(tpl.quantile(1/3)(['trials']))\n                .toBe 102\n                expect getVal(tpl.quantile(1)(['trials']))\n                .toBe 112\n\n        describe \".var\", ->\n            it \"works\", ->\n                expect getVal(tpl.var()(['trials']))\n                .toBe 48.666666666666686\n\n        describe \".stdev\", ->\n            it \"works\", ->\n                expect getVal(tpl.stdev()(['trials']))\n                .toBe 6.976149845485451\n\n        describe \".sumOverSum\", ->\n            it \"works\", ->\n                expect getVal(tpl.sumOverSum()(['successes', 'trials']))\n                .toBe (12+25+30+14)/(95+102+103+112)\n\n    describe \".naturalSort()\", ->\n        naturalSort = $.pivotUtilities.naturalSort\n\n        sortedArr = [\n            null, NaN,\n            -Infinity, '-Infinity', -3, '-3', -2, '-2', -1, '-1',\n            0, '2e-1', 1, '01', '1', 2, '002', '002e0', '02', '2', '2e-0',\n            3, 10, '10', '11', '12', '1e2', '112', Infinity, 'Infinity',\n            '1a', '2a','12a','20a',\n            'A', 'A', 'NaN', 'a', 'a',\n            'a01', 'a012', 'a02', 'a1', 'a2', 'a12', 'a12', 'a21', 'a21',\n            'b', 'c', 'd', 'null'\n        ]\n\n        it \"sorts naturally (null, NaN, numbers & numbery strings, Alphanum for text strings)\", ->\n            expect sortedArr.slice().sort(naturalSort)\n            .toEqual sortedArr\n\n    describe \".sortAs()\", ->\n        sortAs = $.pivotUtilities.sortAs\n\n        it \"sorts with unknown values sorted at the end\", ->\n            expect [5,2,3,4,1].sort sortAs([4,3,2])\n            .toEqual [4,3,2,1,5]\n\n        it \"sorts lowercase after uppercase\", ->\n            expect [\"Ab\",\"aA\",\"aa\",\"ab\"].sort sortAs([\"Ab\",\"Aa\"])\n            .toEqual [\"Ab\",\"ab\",\"aa\",\"aA\"]\n\n    describe \".numberFormat()\", ->\n        numberFormat = $.pivotUtilities.numberFormat\n\n        it \"formats numbers\", ->\n            nf = numberFormat()\n            expect nf 1234567.89123456\n            .toEqual \"1,234,567.89\"\n\n        it \"formats booleans\", ->\n            nf = numberFormat()\n            expect nf true\n            .toEqual \"1.00\"\n\n        it \"formats numbers in strings\", ->\n            nf = numberFormat()\n            expect nf \"1234567.89123456\"\n            .toEqual \"1,234,567.89\"\n\n        it \"doesn't formats strings\", ->\n            nf = numberFormat()\n            expect nf \"hi there\"\n            .toEqual \"\"\n\n        it \"doesn't formats objects\", ->\n            nf = numberFormat()\n            expect nf {a:1}\n            .toEqual \"\"\n\n        it \"formats percentages\", ->\n            nf = numberFormat(scaler: 100, suffix: \"%\")\n            expect nf 0.12345\n            .toEqual \"12.35%\"\n\n        it \"adds separators\", ->\n            nf = numberFormat(thousandsSep: \"a\", decimalSep: \"b\")\n            expect nf 1234567.89123456\n            .toEqual \"1a234a567b89\"\n\n        it \"adds prefixes and suffixes\", ->\n            nf = numberFormat(prefix: \"a\", suffix: \"b\")\n            expect nf 1234567.89123456\n            .toEqual \"a1,234,567.89b\"\n\n        it \"scales and rounds\", ->\n            nf = numberFormat(digitsAfterDecimal: 3, scaler: 1000)\n            expect nf 1234567.89123456\n            .toEqual \"1,234,567,891.235\"\n\n    describe \".derivers\", ->\n        describe \".dateFormat()\", ->\n            df = $.pivotUtilities.derivers.dateFormat \"x\", \"abc % %% %%% %a %y %m %n %d %w %x %H %M %S\", true\n\n            it \"formats date objects\", ->\n                expect df {x: new Date(\"2015-01-02T23:43:11Z\")}\n                .toBe 'abc % %% %%% %a 2015 01 Jan 02 Fri 5 23 43 11'\n\n            it \"formats input parsed by Date.parse()\", ->\n                expect df {x: \"2015-01-02T23:43:11Z\"}\n                .toBe 'abc % %% %%% %a 2015 01 Jan 02 Fri 5 23 43 11'\n\n                expect df {x: \"bla\"}\n                .toBe ''\n\n        describe \".bin()\", ->\n            binner = $.pivotUtilities.derivers.bin \"x\", 10\n\n            it \"bins numbers\", ->\n                expect binner {x: 11}\n                .toBe 10\n\n                expect binner {x: 9}\n                .toBe 0\n\n                expect binner {x: 111}\n                .toBe 110\n\n            it \"bins booleans\", ->\n                expect binner {x: true}\n                .toBe 0\n\n            it \"bins negative numbers\", ->\n                expect binner {x: -12}\n                .toBe -10\n\n            it \"doesn't bin strings\", ->\n                expect binner {x: \"a\"}\n                .toBeNaN()\n\n            it \"doesn't bin objects\", ->\n                expect binner {x: {a:1}}\n                .toBeNaN()\n","(function() {\n  var fixtureData, raggedFixtureData;\n\n  fixtureData = [[\"name\", \"gender\", \"colour\", \"birthday\", \"trials\", \"successes\"], [\"Nick\", \"male\", \"blue\", \"1982-11-07\", 103, 12], [\"Jane\", \"female\", \"red\", \"1982-11-08\", 95, 25], [\"John\", \"male\", \"blue\", \"1982-12-08\", 112, 30], [\"Carol\", \"female\", \"yellow\", \"1983-12-08\", 102, 14]];\n\n  raggedFixtureData = [\n    {\n      name: \"Nick\",\n      \"colour\": \"red\",\n      \"age\": 34\n    }, {\n      name: \"Jane\",\n      \"gender\": \"female\"\n    }, {\n      name: \"John\",\n      \"gender\": \"male\",\n      \"age\": 12\n    }, {\n      name: \"Jim\",\n      \"gender\": null,\n      \"age\": 12\n    }\n  ];\n\n  describe(\"$.pivotUI()\", function() {\n    describe(\"with no rows/cols, default count aggregator, default TableRenderer\", function() {\n      var table;\n      table = null;\n      beforeEach(function(done) {\n        return table = $(\"<div>\").pivotUI(fixtureData, {\n          onRefresh: done\n        });\n      });\n      it(\"has all the basic UI elements\", function(done) {\n        expect(table.find(\"td.pvtAxisContainer\").length).toBe(3);\n        expect(table.find(\"td.pvtRendererArea\").length).toBe(1);\n        expect(table.find(\"td.pvtVals\").length).toBe(1);\n        expect(table.find(\"select.pvtRenderer\").length).toBe(1);\n        expect(table.find(\"select.pvtAggregator\").length).toBe(1);\n        expect(table.find(\"span.pvtAttr\").length).toBe(6);\n        return done();\n      });\n      it(\"reflects its inputs\", function(done) {\n        expect(table.find(\"td.pvtUnused span.pvtAttr\").length).toBe(6);\n        expect(table.find(\"select.pvtRenderer\").val()).toBe(\"Table\");\n        expect(table.find(\"select.pvtAggregator\").val()).toBe(\"Count\");\n        return done();\n      });\n      it(\"renders a table\", function(done) {\n        expect(table.find(\"table.pvtTable\").length).toBe(1);\n        return done();\n      });\n      return describe(\"its renderer output\", function() {\n        it(\"has the correct type and number of cells\", function(done) {\n          expect(table.find(\"th.pvtTotalLabel\").length).toBe(1);\n          expect(table.find(\"td.pvtGrandTotal\").length).toBe(1);\n          return done();\n        });\n        it(\"has the correct textual representation\", function(done) {\n          expect(table.find(\"table.pvtTable\").text()).toBe([\"Totals\", \"4\"].join(\"\"));\n          return done();\n        });\n        return it(\"has a correct grand total with data value\", function(done) {\n          expect(table.find(\"td.pvtGrandTotal\").text()).toBe(\"4\");\n          expect(table.find(\"td.pvtGrandTotal\").data(\"value\")).toBe(4);\n          return done();\n        });\n      });\n    });\n    describe(\"with rows/cols, sum-over-sum aggregator, Heatmap renderer\", function() {\n      var table;\n      table = null;\n      beforeEach(function(done) {\n        return table = $(\"<div>\").pivotUI(fixtureData, {\n          rows: [\"gender\"],\n          cols: [\"colour\"],\n          aggregatorName: \"Sum over Sum\",\n          vals: [\"successes\", \"trials\"],\n          rendererName: \"Heatmap\",\n          onRefresh: done\n        });\n      });\n      it(\"has all the basic UI elements\", function(done) {\n        expect(table.find(\"td.pvtAxisContainer\").length).toBe(3);\n        expect(table.find(\"td.pvtRendererArea\").length).toBe(1);\n        expect(table.find(\"td.pvtVals\").length).toBe(1);\n        expect(table.find(\"select.pvtRenderer\").length).toBe(1);\n        expect(table.find(\"select.pvtAggregator\").length).toBe(1);\n        expect(table.find(\"span.pvtAttr\").length).toBe(6);\n        return done();\n      });\n      it(\"reflects its inputs\", function(done) {\n        expect(table.find(\"td.pvtUnused span.pvtAttr\").length).toBe(4);\n        expect(table.find(\"td.pvtRows span.pvtAttr\").length).toBe(1);\n        expect(table.find(\"td.pvtCols span.pvtAttr\").length).toBe(1);\n        expect(table.find(\"select.pvtRenderer\").val()).toBe(\"Heatmap\");\n        expect(table.find(\"select.pvtAggregator\").val()).toBe(\"Sum over Sum\");\n        return done();\n      });\n      it(\"renders a table\", function(done) {\n        expect(table.find(\"table.pvtTable\").length).toBe(1);\n        return done();\n      });\n      return describe(\"its renderer output\", function() {\n        it(\"has the correct type and number of cells\", function(done) {\n          expect(table.find(\"th.pvtAxisLabel\").length).toBe(2);\n          expect(table.find(\"th.pvtRowLabel\").length).toBe(2);\n          expect(table.find(\"th.pvtColLabel\").length).toBe(3);\n          expect(table.find(\"th.pvtTotalLabel\").length).toBe(2);\n          expect(table.find(\"td.pvtVal\").length).toBe(6);\n          expect(table.find(\"td.pvtTotal\").length).toBe(5);\n          expect(table.find(\"td.pvtGrandTotal\").length).toBe(1);\n          return done();\n        });\n        it(\"has the correct textual representation\", function(done) {\n          expect(table.find(\"table.pvtTable\").text()).toBe([\"colour\", \"blue\", \"red\", \"yellow\", \"Totals\", \"gender\", \"female\", \"0.26\", \"0.14\", \"0.20\", \"male\", \"0.20\", \"0.20\", \"Totals\", \"0.20\", \"0.26\", \"0.14\", \"0.20\"].join(\"\"));\n          return done();\n        });\n        return it(\"has a correct spot-checked cell with data value\", function(done) {\n          expect(table.find(\"td.col0.row1\").text()).toBe(\"0.20\");\n          expect(table.find(\"td.col0.row1\").data(\"value\")).toBe((12 + 30) / (103 + 112));\n          return done();\n        });\n      });\n    });\n    return describe(\"with ragged input\", function() {\n      var table;\n      table = $(\"<div>\").pivotUI(raggedFixtureData, {\n        rows: [\"gender\"],\n        cols: [\"age\"]\n      });\n      return it(\"renders a table with the correct textual representation\", function() {\n        return expect(table.find(\"table.pvtTable\").text()).toBe([\"age\", \"12\", \"34\", \"null\", \"Totals\", \"gender\", \"female\", \"1\", \"1\", \"male\", \"1\", \"1\", \"null\", \"1\", \"1\", \"2\", \"Totals\", \"2\", \"1\", \"1\", \"4\"].join(\"\"));\n      });\n    });\n  });\n\n  describe(\"$.pivot()\", function() {\n    describe(\"with no rows/cols, default count aggregator, default TableRenderer\", function() {\n      var table;\n      table = $(\"<div>\").pivot(fixtureData);\n      it(\"renders a table\", function() {\n        return expect(table.find(\"table.pvtTable\").length).toBe(1);\n      });\n      return describe(\"its renderer output\", function() {\n        it(\"has the correct textual representation\", function() {\n          return expect(table.find(\"table.pvtTable\").text()).toBe([\"Totals\", \"4\"].join(\"\"));\n        });\n        return it(\"has a correct grand total with data value\", function() {\n          expect(table.find(\"td.pvtGrandTotal\").text()).toBe(\"4\");\n          return expect(table.find(\"td.pvtGrandTotal\").data(\"value\")).toBe(4);\n        });\n      });\n    });\n    describe(\"with rows/cols, sum aggregator, derivedAttributes, filter and sorters\", function() {\n      var aggregators, derivers, ref, sortAs, table;\n      ref = $.pivotUtilities, sortAs = ref.sortAs, derivers = ref.derivers, aggregators = ref.aggregators;\n      table = $(\"<div>\").pivot(fixtureData, {\n        rows: [\"gender\"],\n        cols: [\"birthyear\"],\n        aggregator: aggregators[\"Sum\"]([\"trialbins\"]),\n        filter: function(record) {\n          return record.name !== \"Nick\";\n        },\n        derivedAttributes: {\n          birthyear: derivers.dateFormat(\"birthday\", \"%y\"),\n          trialbins: derivers.bin(\"trials\", 10)\n        },\n        sorters: function(attr) {\n          if (attr === \"gender\") {\n            return sortAs([\"male\", \"female\"]);\n          }\n        }\n      });\n      return it(\"renders a table with the correct textual representation\", function() {\n        return expect(table.find(\"table.pvtTable\").text()).toBe([\"birthyear\", \"1982\", \"1983\", \"Totals\", \"gender\", \"male\", \"110.00\", \"110.00\", \"female\", \"90.00\", \"100.00\", \"190.00\", \"Totals\", \"200.00\", \"100.00\", \"300.00\"].join(\"\"));\n      });\n    });\n    describe(\"with rows/cols, fraction-of aggregator\", function() {\n      var aggregators, table;\n      aggregators = $.pivotUtilities.aggregators;\n      table = $(\"<div>\").pivot(fixtureData, {\n        rows: [\"gender\"],\n        aggregator: aggregators[\"Sum as Fraction of Total\"]([\"trials\"])\n      });\n      return it(\"renders a table with the correct textual representation\", function() {\n        return expect(table.find(\"table.pvtTable\").text()).toBe([\"gender\", \"Totals\", \"female\", \"47.8%\", \"male\", \"52.2%\", \"Totals\", \"100.0%\"].join(\"\"));\n      });\n    });\n    describe(\"with rows/cols, custom aggregator, custom renderer with options\", function() {\n      var received_PivotData, received_rendererOptions, table;\n      received_PivotData = null;\n      received_rendererOptions = null;\n      table = $(\"<div>\").pivot(fixtureData, {\n        rows: [\"name\", \"colour\"],\n        cols: [\"trials\", \"successes\"],\n        aggregator: function() {\n          return {\n            count2x: 0,\n            push: function() {\n              return this.count2x += 2;\n            },\n            value: function() {\n              return this.count2x;\n            },\n            format: function(x) {\n              return \"formatted \" + x;\n            }\n          };\n        },\n        renderer: function(a, b) {\n          received_PivotData = a;\n          received_rendererOptions = b;\n          return $(\"<div>\").addClass(b.greeting).text(\"world\");\n        },\n        rendererOptions: {\n          greeting: \"hithere\"\n        }\n      });\n      it(\"renders the custom renderer as per options\", function() {\n        return expect(table.find(\"div.hithere\").length).toBe(1);\n      });\n      return describe(\"its received PivotData object\", function() {\n        return it(\"has a correct grand total value and format for custom aggregator\", function() {\n          var agg, val;\n          agg = received_PivotData.getAggregator([], []);\n          val = agg.value();\n          expect(val).toBe(8);\n          return expect(agg.format(val)).toBe(\"formatted 8\");\n        });\n      });\n    });\n    return describe(\"with ragged input\", function() {\n      var table;\n      table = $(\"<div>\").pivot(raggedFixtureData, {\n        rows: [\"gender\"],\n        cols: [\"age\"]\n      });\n      return it(\"renders a table with the correct textual representation\", function() {\n        return expect(table.find(\"table.pvtTable\").text()).toBe([\"age\", \"12\", \"34\", \"null\", \"Totals\", \"gender\", \"female\", \"1\", \"1\", \"male\", \"1\", \"1\", \"null\", \"1\", \"1\", \"2\", \"Totals\", \"2\", \"1\", \"1\", \"4\"].join(\"\"));\n      });\n    });\n  });\n\n  describe(\"$.pivotUtilities\", function() {\n    describe(\".PivotData()\", function() {\n      var sumOverSumOpts;\n      sumOverSumOpts = {\n        aggregator: $.pivotUtilities.aggregators[\"Sum over Sum\"]([\"a\", \"b\"])\n      };\n      describe(\"with no options\", function() {\n        var aoaInput, pd;\n        aoaInput = [[\"a\", \"b\"], [1, 2], [3, 4]];\n        pd = new $.pivotUtilities.PivotData(aoaInput);\n        return it(\"has the correct grand total value\", function() {\n          return expect(pd.getAggregator([], []).value()).toBe(2);\n        });\n      });\n      describe(\"with array-of-array input\", function() {\n        var aoaInput, pd;\n        aoaInput = [[\"a\", \"b\"], [1, 2], [3, 4]];\n        pd = new $.pivotUtilities.PivotData(aoaInput, sumOverSumOpts);\n        return it(\"has the correct grand total value\", function() {\n          return expect(pd.getAggregator([], []).value()).toBe((1 + 3) / (2 + 4));\n        });\n      });\n      describe(\"with array-of-object input\", function() {\n        var aosInput, pd;\n        aosInput = [\n          {\n            a: 1,\n            b: 2\n          }, {\n            a: 3,\n            b: 4\n          }\n        ];\n        pd = new $.pivotUtilities.PivotData(aosInput, sumOverSumOpts);\n        return it(\"has the correct grand total value\", function() {\n          return expect(pd.getAggregator([], []).value()).toBe((1 + 3) / (2 + 4));\n        });\n      });\n      describe(\"with ragged array-of-object input\", function() {\n        var pd, raggedAosInput;\n        raggedAosInput = [\n          {\n            a: 1\n          }, {\n            b: 4\n          }, {\n            a: 3,\n            b: 2\n          }\n        ];\n        pd = new $.pivotUtilities.PivotData(raggedAosInput, sumOverSumOpts);\n        return it(\"has the correct grand total value\", function() {\n          return expect(pd.getAggregator([], []).value()).toBe((1 + 3) / (2 + 4));\n        });\n      });\n      describe(\"with function input\", function() {\n        var functionInput, pd;\n        functionInput = function(record) {\n          record({\n            a: 1,\n            b: 2\n          });\n          return record({\n            a: 3,\n            b: 4\n          });\n        };\n        pd = new $.pivotUtilities.PivotData(functionInput, sumOverSumOpts);\n        return it(\"has the correct grand total value\", function() {\n          return expect(pd.getAggregator([], []).value()).toBe((1 + 3) / (2 + 4));\n        });\n      });\n      describe(\"with jQuery table element input\", function() {\n        var pd, tableInput;\n        tableInput = $(\"<table>\\n    <thead>\\n        <tr> <th>a</th><th>b</th> </tr>\\n    </thead>\\n    <tbody>\\n        <tr> <td>1</td> <td>2</td> </tr>\\n        <tr> <td>3</td> <td>4</td> </tr>\\n    </tbody>\\n</table>\");\n        pd = new $.pivotUtilities.PivotData(tableInput, sumOverSumOpts);\n        return it(\"has the correct grand total value\", function() {\n          return expect(pd.getAggregator([], []).value()).toBe((1 + 3) / (2 + 4));\n        });\n      });\n      describe(\"with a0-a00 input\", function() {\n        var aoaInput, pd;\n        aoaInput = [\n          {\n            key: 'a0',\n            ym: '2020-01'\n          }, {\n            key: 'a0',\n            ym: '2020-02'\n          }, {\n            key: 'a00',\n            ym: '2020-01'\n          }, {\n            key: 'a00',\n            ym: '2020-02'\n          }\n        ];\n        pd = new $.pivotUtilities.PivotData(aoaInput, {\n          rows: [\"key\", \"ym\"],\n          cols: []\n        });\n        return it(\"has correctly-ordered row keys\", function() {\n          return expect(pd.getRowKeys()).toEqual([[\"a0\", \"2020-01\"], [\"a0\", \"2020-02\"], [\"a00\", \"2020-01\"], [\"a00\", \"2020-02\"]]);\n        });\n      });\n      return describe(\"with rows/cols\", function() {\n        var pd;\n        pd = new $.pivotUtilities.PivotData(fixtureData, {\n          rows: [\"name\", \"colour\"],\n          cols: [\"trials\", \"successes\"]\n        });\n        it(\"has correctly-ordered row keys\", function() {\n          return expect(pd.getRowKeys()).toEqual([['Carol', 'yellow'], ['Jane', 'red'], ['John', 'blue'], ['Nick', 'blue']]);\n        });\n        it(\"has correctly-ordered col keys\", function() {\n          return expect(pd.getColKeys()).toEqual([[95, 25], [102, 14], [103, 12], [112, 30]]);\n        });\n        it(\"can be iterated over\", function() {\n          var c, i, j, len, len1, numNotNull, numNull, r, ref, ref1;\n          numNotNull = 0;\n          numNull = 0;\n          ref = pd.getRowKeys();\n          for (i = 0, len = ref.length; i < len; i++) {\n            r = ref[i];\n            ref1 = pd.getColKeys();\n            for (j = 0, len1 = ref1.length; j < len1; j++) {\n              c = ref1[j];\n              if (pd.getAggregator(r, c).value() != null) {\n                numNotNull++;\n              } else {\n                numNull++;\n              }\n            }\n          }\n          expect(numNotNull).toBe(4);\n          return expect(numNull).toBe(12);\n        });\n        it(\"returns matching records\", function() {\n          var records;\n          records = [];\n          pd.forEachMatchingRecord({\n            gender: \"male\"\n          }, function(x) {\n            return records.push(x.name);\n          });\n          return expect(records).toEqual([\"Nick\", \"John\"]);\n        });\n        it(\"has a correct spot-checked aggregator\", function() {\n          var agg, val;\n          agg = pd.getAggregator(['Carol', 'yellow'], [102, 14]);\n          val = agg.value();\n          expect(val).toBe(1);\n          return expect(agg.format(val)).toBe(\"1\");\n        });\n        return it(\"has a correct grand total aggregator\", function() {\n          var agg, val;\n          agg = pd.getAggregator([], []);\n          val = agg.value();\n          expect(val).toBe(4);\n          return expect(agg.format(val)).toBe(\"4\");\n        });\n      });\n    });\n    describe(\".aggregatorTemplates\", function() {\n      var getVal, tpl;\n      getVal = function(aggregator) {\n        var pd;\n        pd = new $.pivotUtilities.PivotData(fixtureData, {\n          aggregator: aggregator\n        });\n        return pd.getAggregator([], []).value();\n      };\n      tpl = $.pivotUtilities.aggregatorTemplates;\n      describe(\".count\", function() {\n        return it(\"works\", function() {\n          return expect(getVal(tpl.count()())).toBe(4);\n        });\n      });\n      describe(\".countUnique\", function() {\n        return it(\"works\", function() {\n          return expect(getVal(tpl.countUnique()(['gender']))).toBe(2);\n        });\n      });\n      describe(\".listUnique\", function() {\n        return it(\"works\", function() {\n          return expect(getVal(tpl.listUnique()(['gender']))).toBe('female,male');\n        });\n      });\n      describe(\".average\", function() {\n        return it(\"works\", function() {\n          return expect(getVal(tpl.average()(['trials']))).toBe(103);\n        });\n      });\n      describe(\".sum\", function() {\n        return it(\"works\", function() {\n          return expect(getVal(tpl.sum()(['trials']))).toBe(412);\n        });\n      });\n      describe(\".min\", function() {\n        return it(\"works\", function() {\n          return expect(getVal(tpl.min()(['trials']))).toBe(95);\n        });\n      });\n      describe(\".max\", function() {\n        return it(\"works\", function() {\n          return expect(getVal(tpl.max()(['trials']))).toBe(112);\n        });\n      });\n      describe(\".first\", function() {\n        return it(\"works\", function() {\n          return expect(getVal(tpl.first()(['name']))).toBe('Carol');\n        });\n      });\n      describe(\".last\", function() {\n        return it(\"works\", function() {\n          return expect(getVal(tpl.last()(['name']))).toBe('Nick');\n        });\n      });\n      describe(\".average\", function() {\n        return it(\"works\", function() {\n          return expect(getVal(tpl.average()(['trials']))).toBe(103);\n        });\n      });\n      describe(\".median\", function() {\n        return it(\"works\", function() {\n          return expect(getVal(tpl.median()(['trials']))).toBe(102.5);\n        });\n      });\n      describe(\".quantile\", function() {\n        return it(\"works\", function() {\n          expect(getVal(tpl.quantile(0)(['trials']))).toBe(95);\n          expect(getVal(tpl.quantile(0.1)(['trials']))).toBe(98.5);\n          expect(getVal(tpl.quantile(0.25)(['trials']))).toBe(98.5);\n          expect(getVal(tpl.quantile(1 / 3)(['trials']))).toBe(102);\n          return expect(getVal(tpl.quantile(1)(['trials']))).toBe(112);\n        });\n      });\n      describe(\".var\", function() {\n        return it(\"works\", function() {\n          return expect(getVal(tpl[\"var\"]()(['trials']))).toBe(48.666666666666686);\n        });\n      });\n      describe(\".stdev\", function() {\n        return it(\"works\", function() {\n          return expect(getVal(tpl.stdev()(['trials']))).toBe(6.976149845485451);\n        });\n      });\n      return describe(\".sumOverSum\", function() {\n        return it(\"works\", function() {\n          return expect(getVal(tpl.sumOverSum()(['successes', 'trials']))).toBe((12 + 25 + 30 + 14) / (95 + 102 + 103 + 112));\n        });\n      });\n    });\n    describe(\".naturalSort()\", function() {\n      var naturalSort, sortedArr;\n      naturalSort = $.pivotUtilities.naturalSort;\n      sortedArr = [null, 0/0, -2e308, '-Infinity', -3, '-3', -2, '-2', -1, '-1', 0, '2e-1', 1, '01', '1', 2, '002', '002e0', '02', '2', '2e-0', 3, 10, '10', '11', '12', '1e2', '112', 2e308, 'Infinity', '1a', '2a', '12a', '20a', 'A', 'A', 'NaN', 'a', 'a', 'a01', 'a012', 'a02', 'a1', 'a2', 'a12', 'a12', 'a21', 'a21', 'b', 'c', 'd', 'null'];\n      return it(\"sorts naturally (null, NaN, numbers & numbery strings, Alphanum for text strings)\", function() {\n        return expect(sortedArr.slice().sort(naturalSort)).toEqual(sortedArr);\n      });\n    });\n    describe(\".sortAs()\", function() {\n      var sortAs;\n      sortAs = $.pivotUtilities.sortAs;\n      it(\"sorts with unknown values sorted at the end\", function() {\n        return expect([5, 2, 3, 4, 1].sort(sortAs([4, 3, 2]))).toEqual([4, 3, 2, 1, 5]);\n      });\n      return it(\"sorts lowercase after uppercase\", function() {\n        return expect([\"Ab\", \"aA\", \"aa\", \"ab\"].sort(sortAs([\"Ab\", \"Aa\"]))).toEqual([\"Ab\", \"ab\", \"aa\", \"aA\"]);\n      });\n    });\n    describe(\".numberFormat()\", function() {\n      var numberFormat;\n      numberFormat = $.pivotUtilities.numberFormat;\n      it(\"formats numbers\", function() {\n        var nf;\n        nf = numberFormat();\n        return expect(nf(1234567.89123456)).toEqual(\"1,234,567.89\");\n      });\n      it(\"formats booleans\", function() {\n        var nf;\n        nf = numberFormat();\n        return expect(nf(true)).toEqual(\"1.00\");\n      });\n      it(\"formats numbers in strings\", function() {\n        var nf;\n        nf = numberFormat();\n        return expect(nf(\"1234567.89123456\")).toEqual(\"1,234,567.89\");\n      });\n      it(\"doesn't formats strings\", function() {\n        var nf;\n        nf = numberFormat();\n        return expect(nf(\"hi there\")).toEqual(\"\");\n      });\n      it(\"doesn't formats objects\", function() {\n        var nf;\n        nf = numberFormat();\n        return expect(nf({\n          a: 1\n        })).toEqual(\"\");\n      });\n      it(\"formats percentages\", function() {\n        var nf;\n        nf = numberFormat({\n          scaler: 100,\n          suffix: \"%\"\n        });\n        return expect(nf(0.12345)).toEqual(\"12.35%\");\n      });\n      it(\"adds separators\", function() {\n        var nf;\n        nf = numberFormat({\n          thousandsSep: \"a\",\n          decimalSep: \"b\"\n        });\n        return expect(nf(1234567.89123456)).toEqual(\"1a234a567b89\");\n      });\n      it(\"adds prefixes and suffixes\", function() {\n        var nf;\n        nf = numberFormat({\n          prefix: \"a\",\n          suffix: \"b\"\n        });\n        return expect(nf(1234567.89123456)).toEqual(\"a1,234,567.89b\");\n      });\n      return it(\"scales and rounds\", function() {\n        var nf;\n        nf = numberFormat({\n          digitsAfterDecimal: 3,\n          scaler: 1000\n        });\n        return expect(nf(1234567.89123456)).toEqual(\"1,234,567,891.235\");\n      });\n    });\n    return describe(\".derivers\", function() {\n      describe(\".dateFormat()\", function() {\n        var df;\n        df = $.pivotUtilities.derivers.dateFormat(\"x\", \"abc % %% %%% %a %y %m %n %d %w %x %H %M %S\", true);\n        it(\"formats date objects\", function() {\n          return expect(df({\n            x: new Date(\"2015-01-02T23:43:11Z\")\n          })).toBe('abc % %% %%% %a 2015 01 Jan 02 Fri 5 23 43 11');\n        });\n        return it(\"formats input parsed by Date.parse()\", function() {\n          expect(df({\n            x: \"2015-01-02T23:43:11Z\"\n          })).toBe('abc % %% %%% %a 2015 01 Jan 02 Fri 5 23 43 11');\n          return expect(df({\n            x: \"bla\"\n          })).toBe('');\n        });\n      });\n      return describe(\".bin()\", function() {\n        var binner;\n        binner = $.pivotUtilities.derivers.bin(\"x\", 10);\n        it(\"bins numbers\", function() {\n          expect(binner({\n            x: 11\n          })).toBe(10);\n          expect(binner({\n            x: 9\n          })).toBe(0);\n          return expect(binner({\n            x: 111\n          })).toBe(110);\n        });\n        it(\"bins booleans\", function() {\n          return expect(binner({\n            x: true\n          })).toBe(0);\n        });\n        it(\"bins negative numbers\", function() {\n          return expect(binner({\n            x: -12\n          })).toBe(-10);\n        });\n        it(\"doesn't bin strings\", function() {\n          return expect(binner({\n            x: \"a\"\n          })).toBeNaN();\n        });\n        return it(\"doesn't bin objects\", function() {\n          return expect(binner({\n            x: {\n              a: 1\n            }\n          })).toBeNaN();\n        });\n      });\n    });\n  });\n\n}).call(this);\n\n//# sourceMappingURL=pivot_spec.js.map\n"]}